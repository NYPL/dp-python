<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Rewriting ft.sh - Remote theme example</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Rewriting ft.sh | Remote theme example</title> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Rewriting ft.sh" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/rewrite_ftsh/1_overall.html" /> <meta property="og:url" content="http://localhost:4000/rewrite_ftsh/1_overall.html" /> <meta property="og:site_name" content="Remote theme example" /> <script type="application/ld+json"> {"@type":"WebPage","headline":"Rewriting ft.sh","url":"http://localhost:4000/rewrite_ftsh/1_overall.html","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> Remote theme example </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">About</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/rewrite_ftsh/1_overall.html" class="nav-list-link active">Rewriting ft.sh</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/rewrite_ftsh/1_argparse.html" class="nav-list-link">Creating a command-line script with arguments</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <p>We’re re-implementing <code class="language-plaintext highlighter-rouge">ft.sh</code> in order to learn features of Python scripting. Part of this will be to add features that ft.sh never had.</p> <p>While bash is a very useful language, there are parts that I find really vague. These include things like <a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/getopts.html">parsing command-line arguments</a>, <a href="https://tldp.org/LDP/abs/html/untyped.html">converting between data types</a>, and <a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">how all the shell expansions work</a>. These are features that have made it harder for me to write scripts that work the way I want them to. I will be explaining the difference between bash and Python where I can, but these explanations may be hampered by my own misunderstandings of bash.</p> <h2 id="what-does-ftsh-do"> <a href="#what-does-ftsh-do" class="anchor-heading" aria-labelledby="what-does-ftsh-do"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What does <code class="language-plaintext highlighter-rouge">ft.sh</code> do? </h2> <p><code class="language-plaintext highlighter-rouge">ft.sh</code> is a script used by NYPL Digital Archives copy files from digital carriers into a bag, extract technical metadata from the files on the digital carrier, validate the transfer, and report stats. We will not translate each line of the bash script into Python. Instead, we’ll first extract the features of the script and then implement those from scratch. This is partly because bash and Python have different syntactic styles. Like with language translation, our new script will work better if we capture the spirit of the bash script instead of a dictionary translation.</p> <p><code class="language-plaintext highlighter-rouge">ft.sh</code> has lots of comments and explanatory ‘echo’ statements. We can use those to create a list of features we need to implement.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#This is a program to create Siegfried metadata, bags and validation for file transfers.</span>
<span class="c">#Check that sf conf file is set properly</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="k">${</span><span class="nv">BLUE</span><span class="k">}</span><span class="s2">This script will create a file transfer.</span><span class="k">${</span><span class="nv">NC</span><span class="k">}</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="k">${</span><span class="nv">BLUE</span><span class="k">}</span><span class="s2">Please drag the SIP folder over this window. See the folder path displayed? Hit return!:</span><span class="k">${</span><span class="nv">NC</span><span class="k">}</span><span class="s2">"</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="k">${</span><span class="nv">BLUE</span><span class="k">}</span><span class="s2">Please enter the MediaID for this file transfer and hit return:</span><span class="k">${</span><span class="nv">NC</span><span class="k">}</span><span class="s2">"</span>
<span class="c">#remove - and disk# to create collection#</span>
<span class="c">#echo -e $Collection</span>
<span class="c">#echo -e $Bag</span>
<span class="c">#designate base path</span>
<span class="c">#create MediaID directory</span>
<span class="c">#create sf csv</span>
<span class="c">#create bag, set to verbose output and exclude hidden files</span>
<span class="c">#verify bag is complete</span>
<span class="c">#verify payload checksums</span>
<span class="c">#output number of files in payload</span>
<span class="c">#output size of payload in kb</span>
</code></pre></div></div> <p>From this list, the features a Python version will need are:</p> <ul> <li>Explain the purpose of the script</li> <li>Accept user input for the file path of the digital carrier</li> <li>Accept user input for the Media ID number (M######-####)</li> <li>Extract the Collection number from the Media ID</li> <li>Create folders for the bag and metadata based on the collection ID and Media ID</li> <li>Create a siegfried report from the digital carrier</li> <li>Transfer the files from the carrier to the bag</li> <li>Verify the bagging process</li> <li>Report the size and file count of the transfer</li> </ul> <p>We’ll break these features down into the following lessons.</p> <ol> <li>Creating a command-line script with arguments</li> <li>Parsing filepaths and manipulating strings</li> <li>Running bash commands and looking-before-you-leap</li> <li>Using the bagit library and object-oriented programming</li> </ol> <hr> <h2 class="text-delta">Table of contents</h2> <ul> <li> <a href="http://localhost:4000/rewrite_ftsh/1_argparse.html">Creating a command-line script with arguments</a> </li> </ul> </div> </div> </div> </body> </html>
